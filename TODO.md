# Release and Distribution TODO

> **Note**: This workflow now uses **cargo-dist** for building and packaging. Checksums are automatically generated and uploaded with each release, simplifying the process significantly.

## Required Before First Release

### 1. Create GitHub Release with cargo-dist

- [ ] Tag the release: `git tag v0.1.0 && git push origin v0.1.0`
- [ ] Wait for GitHub Actions workflow to complete
  - Workflow will execute: plan → build (all platforms in parallel) → publish
  - Should take ~10-15 minutes depending on build times
- [ ] Verify all platform binaries are uploaded to the release
  - Look for: `.tar.gz` files (Unix), `.zip` file (Windows), `.sha256` checksum files
  - Expected files:
    - `gitnav-x86_64-unknown-linux-gnu.tar.gz`
    - `gitnav-x86_64-unknown-linux-musl.tar.gz`
    - `gitnav-aarch64-unknown-linux-gnu.tar.gz`
    - `gitnav-x86_64-apple-darwin.tar.gz`
    - `gitnav-aarch64-apple-darwin.tar.gz`
    - `gitnav-x86_64-pc-windows-msvc.zip`
    - Corresponding `.sha256` checksum files for each

### 2. Get SHA256 Hashes from Release Assets

Checksums are automatically generated by cargo-dist and uploaded to the release:

- [ ] Download the `.sha256` checksum files from the GitHub release, or view them on the release page
- [ ] Extract SHA256 values for the macOS binaries (x86_64 and ARM64)
- [ ] Use these values to update the Homebrew formula

### 3. Create Homebrew Tap Repository

- [ ] Create a new repository on GitHub named `homebrew-gitnav`
- [ ] Clone it locally:

  ```bash
  git clone https://github.com/msetsma/homebrew-gitnav.git
  cd homebrew-gitnav
  mkdir -p Formula
  ```

- [ ] Copy the updated formula:

  ```bash
  cp /path/to/gitnav/homebrew/gitnav.rb Formula/gitnav.rb
  ```

- [ ] Commit and push:

  ```bash
  git add Formula/gitnav.rb
  git commit -m "Add gitnav v0.1.0 formula"
  git push
  ```

### 4. Test Homebrew Installation

- [ ] Test the formula locally before publishing:

  ```bash
  brew install --build-from-source ./homebrew/gitnav.rb
  gitnav --version
  brew test gitnav
  brew audit --strict gitnav
  brew uninstall gitnav
  ```

- [ ] Test installation from tap:

  ```bash
  brew install msetsma/gitnav/gitnav
  gitnav --version
  gn --help
  ```

### 5. Publish to crates.io (Optional)

- [ ] Ensure you're logged in to crates.io: `cargo login`
- [ ] Publish: `cargo publish`

## For Future Releases

### Version Update Checklist

- [ ] Update version in `Cargo.toml`
- [ ] Update version in `homebrew/gitnav.rb`
- [ ] Update CHANGELOG.md
- [ ] Commit changes: `git commit -am "Bump version to vX.Y.Z"`
- [ ] Create and push tag: `git tag vX.Y.Z && git push origin vX.Y.Z`
- [ ] Wait for GitHub Actions to complete (cargo-dist will):
  - Automatically build for all platforms
  - Generate archives and checksums
  - Create GitHub release with all artifacts
- [ ] Retrieve SHA256 hashes from the uploaded `.sha256` files in the GitHub release
- [ ] Update `homebrew/gitnav.rb` with new version and SHA256 values
- [ ] Update Homebrew tap repository
- [ ] Test installation from Homebrew tap
- [ ] Publish to crates.io if needed: `cargo publish`

## Additional Package Managers (Future)

### Scoop (Windows)

- [ ] Create scoop bucket
- [ ] Add manifest for gitnav

### APT/DEB Repository (Linux)

- [ ] Set up Debian package building
- [ ] Create APT repository

### AUR (Arch Linux)

- [ ] Create PKGBUILD
- [ ] Submit to AUR

### Cargo-binstall Support

- [ ] Verify cargo-binstall can install from GitHub releases

## cargo-dist Future Enhancements

As your project grows, consider enabling these cargo-dist features:

### Installers (Update dist.toml)

- [ ] Shell installer script for Unix systems (`.sh`)
- [ ] PowerShell installer for Windows (`.ps1`)
- [ ] Homebrew formula auto-generation
- [ ] Update `installers` field in `dist.toml` to include these

### Automated Publishing

- [ ] Set up npm publishing for Node.js wrapper (if applicable)
- [ ] Enable Homebrew tap auto-submission
- [ ] Configure cargo publish in workflow

### Release Notes

- [ ] Set up automatic changelog generation from commits
- [ ] Configure commit message parsing for release notes
- [ ] Update release notes template in workflow

### Binary Signing

- [ ] Set up GPG key for signing releases
- [ ] Configure signature generation in dist.toml
- [ ] Publish signatures alongside binaries
